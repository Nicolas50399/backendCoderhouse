<html lang="en" style="text-align: center;">
{{> head }}

<body>
  {{> header}}

  <!-- Begin page content -->
  <main role="main" class="container">
    <img width="50" height="50" src="https://img.icons8.com/ios/50/home-page.png" alt="home-page" style="margin-top: 1rem;"/>
    <h1>Bienvenido {{name}}</h1>
    <h2>Email: {{mail}}</h2>
    <h1 class="mt-5">Productos</h1>
    <table class="table table-dark" style="text-align: center;">
      <thead>
        <tr>
          <th scope="col">Nombre</th>
          <th scope="col">Marca</th>
          <th scope="col">Precio</th>
          <th scope="col">Stock</th>
          <th scope="col"></th>
        </tr>
      </thead>
      <tbody>
        {{#each productos}}
        <tr>
          <th scope="col">
            <p>
              {{this.nombre}}
            </p>
            <img src="images/products/{{this.foto}}" alt="IMG PRODUCTO" width="70%" height="70%">
          </th>
          <th scope="col" style="">{{this.marca}}</th>
          <th scope="col">$ {{this.precio}}</th>
          <th scope="col">{{this.stock}}</th>
          <th scope="col">
            <a href="/producto/{{this._id}}" type="submit">Ver detalles</a>
          </th>
          <th scope="col">
            <form method="POST" action="/agregar/{{this._id}}">
            <input type="number" id="inputCantProducto" class="form-control" placeholder="Cantidad" required name="cantidad" max="{{this.stock}}" />
              <button class="btn btn-lg btn-success btn-block" type="submit"  onclick="return confirm('¿Esta seguro de agregar el producto al carrito?')">
                Agregar
              </button>
            </form>
            <div style="display: flex; flex-direction:row; justify-content:center; align-items:center">
              <form method="POST" action="/eliminar/{{this._id}}" style="margin: auto;">
                <button class="btn btn-lg btn-danger btn-block" type="submit" onclick="return confirm('¿Esta seguro de eliminar el producto?')">
                  Eliminar
                </button>
              </form>
              <!-- Button trigger modal -->
              <button type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#exampleModal{{this._id}}"
                style="height: 47">
                Modificar
              </button>

              <!-- Modal -->
              <div class="modal fade" id="exampleModal{{this._id}}" tabindex="-1" aria-labelledby="exampleModalLabel"
                aria-hidden="true" style="color: black">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h1 class="modal-title fs-5" id="exampleModalLabel">Modificar Producto</h1>
                    </div>
                    <form method="POST" action="/modificar/{{this._id}}" enctype="multipart/form-data" style="margin: auto;">
                      <div class="modal-body">
                        <label for="inputNombreProducto" class="sr-only">Nombre</label>
                        <input type="text" id="inputNombreProducto" class="form-control" placeholder="{{this.nombre}}"
                          required autofocus name="nombreM" />

                        <label for="inputMarcaProducto" class="sr-only">Descripcion</label>
                        <input type="text" id="inputDescripcionProducto" class="form-control"
                          placeholder="{{this.descripcion}}" required autofocus name="descripcionM" />

                        <label for="inputMarcaProducto" class="sr-only">Marca</label>
                        <input type="text" id="inputMarcaProducto" class="form-control" placeholder="{{this.marca}}"
                          required autofocus name="marcaM" />
                        <br>
                        <select class="form-select" aria-label="Default select example" id="inputCategoriaProducto"
                          name="categoriaM">
                          <option selected>Categoria</option>
                          <option value="hogar">Hogar</option>
                          <option value="electrodomestico">Electrodomestico</option>
                          <option value="vestimenta">Vestimenta</option>
                          <option value="comida">Comida</option>
                          <option value="otra">Otra</option>
                        </select>

                        <label for="inputPrecio" class="sr-only">Precio</label>
                        <input type="number" id="inputPrecioProducto" class="form-control" placeholder="{{this.precio}}"
                          required name="precioM" />
                        <label for="inputStock" class="sr-only">Stock</label>
                        <input type="number" id="inputStockProducto" class="form-control" placeholder="{{this.stock}}"
                          required name="stockM" />
                        <label for="inputFotoUsuario" class="form-label">Foto</label>
                        <input class="form-control form-control-lg" id="inputFotoProducto" type="file"
                          placeholder="{{this.foto}}" name="foto">
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>

                        <button type="submit" class="btn btn-primary"  onclick="return confirm('¿Esta seguro de modificar el producto?')">Guardar cambios</button>

                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </th>
        </tr>

        {{/each}}
      </tbody>
    </table>
    <a class="btn btn-lg btn-warning btn-block" href="/cart">
    <img width="40" height="40" src="https://img.icons8.com/dotty/80/shopping-cart.png" alt="shopping-cart"/>
      Ir al carrito
    </a>
  </main>

  {{> footer}}

  <!-- Bootstrap core JavaScript
    ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
  <script src="https://getbootstrap.com/docs/4.0/assets/js/vendor/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
</body>

</html>